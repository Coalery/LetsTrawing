/*! For license information please see c946b5e2b0dbd32544e13ec6cf1adf26acf56c46-370c9e1394d423f34d62.js.LICENSE.txt */
(self.webpackChunklets_trawing=self.webpackChunklets_trawing||[]).push([[427,485],{3646:function(e,t,n){var s=n(7228);e.exports=function(e){if(Array.isArray(e))return s(e)},e.exports.__esModule=!0,e.exports.default=e.exports},4575:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},3913:function(e){function t(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}e.exports=function(e,n,s){return n&&t(e.prototype,n),s&&t(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},9713:function(e){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},6860:function(e){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},8206:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},9591:function(e,t,n){var s=n(8).default;function o(){"use strict";e.exports=o=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(j){l=function(e,t,n){return e[t]=n}}function h(e,t,n,s){var o=t&&t.prototype instanceof p?t:p,r=Object.create(o.prototype),i=new L(s||[]);return r._invoke=function(e,t,n){var s="suspendedStart";return function(o,r){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===o)throw r;return T()}for(n.method=o,n.arg=r;;){var i=n.delegate;if(i){var a=x(i,n);if(a){if(a===m)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===s)throw s="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);s="executing";var c=f(e,t,n);if("normal"===c.type){if(s=n.done?"completed":"suspendedYield",c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(s="completed",n.method="throw",n.arg=c.arg)}}}(e,n,i),r}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(j){return{type:"throw",arg:j}}}t.wrap=h;var m={};function p(){}function d(){}function g(){}var v={};l(v,a,(function(){return this}));var _=Object.getPrototypeOf,y=_&&_(_(O([])));y&&y!==n&&r.call(y,a)&&(v=y);var b=g.prototype=p.prototype=Object.create(v);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function n(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==s(h)&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,c)}))}c(u.arg)}var o;this._invoke=function(e,s){function r(){return new t((function(t,o){n(e,s,t,o)}))}return o=o?o.then(r,r):r()}}function x(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var s=f(n,e.iterator,t.arg);if("throw"===s.type)return t.method="throw",t.arg=s.arg,t.delegate=null,m;var o=s.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function O(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,s=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return s.next=s}}return{next:T}}function T(){return{value:void 0,done:!0}}return d.prototype=g,l(b,"constructor",g),l(g,"constructor",d),d.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,u,"GeneratorFunction")),e.prototype=Object.create(b),e},t.awrap=function(e){return{__await:e}},w(k.prototype),l(k.prototype,c,(function(){return this})),t.AsyncIterator=k,t.async=function(e,n,s,o,r){void 0===r&&(r=Promise);var i=new k(h(e,n,s,o),r);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(b),l(b,u,"Generator"),l(b,a,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var s=t.pop();if(s in e)return n.value=s,n.done=!1,n}return n.done=!0,n}},t.values=O,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,s){return i.type="throw",i.arg=e,t.next=n,s&&(t.method="next",t.arg=void 0),!!s}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc<=this.prev&&r.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var o=s;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var s=n.completion;if("throw"===s.type){var o=s.arg;E(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:O(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),m}},t}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},319:function(e,t,n){var s=n(3646),o=n(6860),r=n(379),i=n(8206);e.exports=function(e){return s(e)||o(e)||r(e)||i()},e.exports.__esModule=!0,e.exports.default=e.exports},8:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},7757:function(e,t,n){var s=n(9591)();e.exports=s;try{regeneratorRuntime=s}catch(o){"object"==typeof globalThis?globalThis.regeneratorRuntime=s:Function("r","regeneratorRuntime = r")(s)}},5900:function(e,t){var n;!function(){"use strict";var s={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var r=typeof n;if("string"===r||"number"===r)e.push(n);else if(Array.isArray(n)){if(n.length){var i=o.apply(null,n);i&&e.push(i)}}else if("object"===r)if(n.toString===Object.prototype.toString)for(var a in n)s.call(n,a)&&n[a]&&e.push(a);else e.push(n.toString())}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},7555:function(e){"use strict";var t,n="object"==typeof Reflect?Reflect:null,s=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function r(){r.init.call(this)}e.exports=r,e.exports.once=function(e,t){return new Promise((function(n,s){function o(n){e.removeListener(t,r),s(n)}function r(){"function"==typeof e.removeListener&&e.removeListener("error",o),n([].slice.call(arguments))}d(e,t,r,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&d(e,"error",t,n)}(e,o,{once:!0})}))},r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var i=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?r.defaultMaxListeners:e._maxListeners}function u(e,t,n,s){var o,r,i,u;if(a(n),void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),r=e._events),i=r[t]),void 0===i)i=r[t]=n,++e._eventsCount;else if("function"==typeof i?i=r[t]=s?[n,i]:[i,n]:s?i.unshift(n):i.push(n),(o=c(e))>0&&i.length>o&&!i.warned){i.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=i.length,u=l,console&&console.warn&&console.warn(u)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var s={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=l.bind(s);return o.listener=n,s.wrapFn=o,o}function f(e,t,n){var s=e._events;if(void 0===s)return[];var o=s[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):p(o,o.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),s=0;s<t;++s)n[s]=e[s];return n}function d(e,t,n,s){if("function"==typeof e.on)s.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(r){s.once&&e.removeEventListener(t,o),n(r)}))}}Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");i=e}}),r.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},r.prototype.getMaxListeners=function(){return c(this)},r.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var o="error"===e,r=this._events;if(void 0!==r)o=o&&void 0===r.error;else if(!o)return!1;if(o){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var c=r[e];if(void 0===c)return!1;if("function"==typeof c)s(c,this,t);else{var u=c.length,l=p(c,u);for(n=0;n<u;++n)s(l[n],this,t)}return!0},r.prototype.addListener=function(e,t){return u(this,e,t,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(e,t){return u(this,e,t,!0)},r.prototype.once=function(e,t){return a(t),this.on(e,h(this,e,t)),this},r.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,h(this,e,t)),this},r.prototype.removeListener=function(e,t){var n,s,o,r,i;if(a(t),void 0===(s=this._events))return this;if(void 0===(n=s[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,r=n.length-1;r>=0;r--)if(n[r]===t||n[r].listener===t){i=n[r].listener,o=r;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(s[e]=n[0]),void 0!==s.removeListener&&this.emit("removeListener",e,i||t)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(e){var t,n,s;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,r=Object.keys(n);for(s=0;s<r.length;++s)"removeListener"!==(o=r[s])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(s=t.length-1;s>=0;s--)this.removeListener(e,t[s]);return this},r.prototype.listeners=function(e){return f(this,e,!0)},r.prototype.rawListeners=function(e){return f(this,e,!1)},r.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},r.prototype.listenerCount=m,r.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},8746:function(e,t,n){var s=n(6002);e.exports={client:s,Client:s}},1913:function(e,t,n){var s=n(9713);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var i=n(2604),a=n(9747);e.exports=function(e,t){var n=void 0!==e.url?e.url:e.uri;if(a.isURL(n)||(n="https://api.twitch.tv/kraken".concat("/"===n[0]?n:"/".concat(n))),a.isNode()){var s=Object.assign({method:"GET",json:!0},e);if(s.qs){var o=new URLSearchParams(s.qs);n+="?".concat(o)}var c={};"fetchAgent"in this.opts.connection&&(c.agent=this.opts.connection.fetchAgent);var u=i(n,r(r({},c),{},{method:s.method,headers:s.headers,body:s.body})),l={};u.then((function(e){return l={statusCode:e.status,headers:e.headers},s.json?e.json():e.text()})).then((function(e){return t(null,l,e)}),(function(e){return t(e,l,null)}))}else{var h=Object.assign({method:"GET",headers:{}},e,{url:n}),f=new XMLHttpRequest;for(var m in f.open(h.method,h.url,!0),h.headers)f.setRequestHeader(m,h.headers[m]);f.responseType="json",f.addEventListener("load",(function(e){4===f.readyState&&(200!==f.status?t(f.status,null,null):t(null,null,f.response))})),f.send()}}},6002:function(e,t,n){var s=n(9713),o=n(319);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var a=void 0!==n.g?n.g:"undefined"!=typeof window?window:{},c=a.WebSocket||n(8726),u=a.fetch||n(2604),l=n(1913),h=n(5088),f=n(1322).EventEmitter,m=n(6778),p=n(8322),d=n(196),g=n(9747),v=!1,_=function e(t){if(this instanceof e==!1)return new e(t);this.opts=g.get(t,{}),this.opts.channels=this.opts.channels||[],this.opts.connection=this.opts.connection||{},this.opts.identity=this.opts.identity||{},this.opts.options=this.opts.options||{},this.clientId=g.get(this.opts.options.clientId,null),this._globalDefaultChannel=g.channel(g.get(this.opts.options.globalDefaultChannel,"#tmijs")),this._skipMembership=g.get(this.opts.options.skipMembership,!1),this._skipUpdatingEmotesets=g.get(this.opts.options.skipUpdatingEmotesets,!1),this._updateEmotesetsTimer=null,this._updateEmotesetsTimerDelay=g.get(this.opts.options.updateEmotesetsTimer,6e4),this.maxReconnectAttempts=g.get(this.opts.connection.maxReconnectAttempts,1/0),this.maxReconnectInterval=g.get(this.opts.connection.maxReconnectInterval,3e4),this.reconnect=g.get(this.opts.connection.reconnect,!0),this.reconnectDecay=g.get(this.opts.connection.reconnectDecay,1.5),this.reconnectInterval=g.get(this.opts.connection.reconnectInterval,1e3),this.reconnecting=!1,this.reconnections=0,this.reconnectTimer=this.reconnectInterval,this.secure=g.get(this.opts.connection.secure,!this.opts.connection.server&&!this.opts.connection.port),this.emotes="",this.emotesets={},this.channels=[],this.currentLatency=0,this.globaluserstate={},this.lastJoined="",this.latency=new Date,this.moderators={},this.pingLoop=null,this.pingTimeout=null,this.reason="",this.username="",this.userstate={},this.wasCloseCalled=!1,this.ws=null;var n="error";this.opts.options.debug&&(n="info"),this.log=this.opts.logger||m;try{m.setLevel(n)}catch(s){}this.opts.channels.forEach((function(e,t,n){return n[t]=g.channel(e)})),f.call(this),this.setMaxListeners(0)};for(var y in g.inherits(_,f),h)_.prototype[y]=h[y];_.prototype.emits=function(e,t){for(var n=0;n<e.length;n++){var s=n<t.length?t[n]:t[t.length-1];this.emit.apply(this,[e[n]].concat(s))}},_.prototype.api=function(){v||(this.log.warn("Client.prototype.api is deprecated and will be removed for version 2.0.0"),v=!0),l.apply(void 0,arguments)},_.prototype.handleMessage=function(e){var t=this;if(e){this.listenerCount("raw_message")&&this.emit("raw_message",JSON.parse(JSON.stringify(e)),e);var n=g.channel(g.get(e.params[0],null)),s=g.get(e.params[1],null),r=g.get(e.tags["msg-id"],null),i=e.tags=p.badges(p.badgeInfo(p.emotes(e.tags)));for(var a in i)if("emote-sets"!==a&&"ban-duration"!==a&&"bits"!==a){var c=i[a];"boolean"==typeof c?c=null:"1"===c?c=!0:"0"===c?c=!1:"string"==typeof c&&(c=g.unescapeIRC(c)),i[a]=c}if(null===e.prefix)switch(e.command){case"PING":this.emit("ping"),this._isConnected()&&this.ws.send("PONG");break;case"PONG":var u=new Date;this.currentLatency=(u.getTime()-this.latency.getTime())/1e3,this.emits(["pong","_promisePing"],[[this.currentLatency]]),clearTimeout(this.pingTimeout);break;default:this.log.warn("Could not parse message with no prefix:\n".concat(JSON.stringify(e,null,4)))}else if("tmi.twitch.tv"===e.prefix)switch(e.command){case"002":case"003":case"004":case"372":case"375":case"CAP":case"SERVERCHANGE":break;case"001":this.username=e.params[0];break;case"376":this.log.info("Connected to server."),this.userstate[this._globalDefaultChannel]={},this.emits(["connected","_promiseConnect"],[[this.server,this.port],[null]]),this.reconnections=0,this.reconnectTimer=this.reconnectInterval,this.pingLoop=setInterval((function(){t._isConnected()&&t.ws.send("PING"),t.latency=new Date,t.pingTimeout=setTimeout((function(){null!==t.ws&&(t.wasCloseCalled=!1,t.log.error("Ping timeout."),t.ws.close(),clearInterval(t.pingLoop),clearTimeout(t.pingTimeout),clearTimeout(t._updateEmotesetsTimer))}),g.get(t.opts.connection.timeout,9999))}),6e4);var l=g.get(this.opts.options.joinInterval,2e3);l<300&&(l=300);var h=new d(l),f=o(new Set([].concat(o(this.opts.channels),o(this.channels))));this.channels=[];for(var m=function(e){var n=f[e];h.add((function(){t._isConnected()&&t.join(n).catch((function(e){return t.log.error(e)}))}))},v=0;v<f.length;v++)m(v);h.next();break;case"NOTICE":var _=[null],y=[n,r,s],b=[n,!0],w=[n,!1],k=[y,_],x=[y,[r]],C="[".concat(n,"] ").concat(s);switch(r){case"subs_on":this.log.info("[".concat(n,"] This room is now in subscribers-only mode.")),this.emits(["subscriber","subscribers","_promiseSubscribers"],[b,b,_]);break;case"subs_off":this.log.info("[".concat(n,"] This room is no longer in subscribers-only mode.")),this.emits(["subscriber","subscribers","_promiseSubscribersoff"],[w,w,_]);break;case"emote_only_on":this.log.info("[".concat(n,"] This room is now in emote-only mode.")),this.emits(["emoteonly","_promiseEmoteonly"],[b,_]);break;case"emote_only_off":this.log.info("[".concat(n,"] This room is no longer in emote-only mode.")),this.emits(["emoteonly","_promiseEmoteonlyoff"],[w,_]);break;case"slow_on":case"slow_off":case"followers_on_zero":case"followers_on":case"followers_off":case"host_on":case"host_off":break;case"r9k_on":this.log.info("[".concat(n,"] This room is now in r9k mode.")),this.emits(["r9kmode","r9kbeta","_promiseR9kbeta"],[b,b,_]);break;case"r9k_off":this.log.info("[".concat(n,"] This room is no longer in r9k mode.")),this.emits(["r9kmode","r9kbeta","_promiseR9kbetaoff"],[w,w,_]);break;case"room_mods":var E=s.split(": "),L=(E.length>1?E[1]:"").toLowerCase().split(", ").filter((function(e){return e}));this.emits(["_promiseMods","mods"],[[null,L],[n,L]]);break;case"no_mods":this.emits(["_promiseMods","mods"],[[null,[]],[n,[]]]);break;case"vips_success":s.endsWith(".")&&(s=s.slice(0,-1));var O=s.split(": "),T=(O.length>1?O[1]:"").toLowerCase().split(", ").filter((function(e){return e}));this.emits(["_promiseVips","vips"],[[null,T],[n,T]]);break;case"no_vips":this.emits(["_promiseVips","vips"],[[null,[]],[n,[]]]);break;case"already_banned":case"bad_ban_admin":case"bad_ban_anon":case"bad_ban_broadcaster":case"bad_ban_global_mod":case"bad_ban_mod":case"bad_ban_self":case"bad_ban_staff":case"usage_ban":this.log.info(C),this.emits(["notice","_promiseBan"],x);break;case"ban_success":this.log.info(C),this.emits(["notice","_promiseBan"],k);break;case"usage_clear":this.log.info(C),this.emits(["notice","_promiseClear"],x);break;case"usage_mods":this.log.info(C),this.emits(["notice","_promiseMods"],[y,[r,[]]]);break;case"mod_success":this.log.info(C),this.emits(["notice","_promiseMod"],k);break;case"usage_vips":this.log.info(C),this.emits(["notice","_promiseVips"],[y,[r,[]]]);break;case"usage_vip":case"bad_vip_grantee_banned":case"bad_vip_grantee_already_vip":case"bad_vip_max_vips_reached":case"bad_vip_achievement_incomplete":this.log.info(C),this.emits(["notice","_promiseVip"],[y,[r,[]]]);break;case"vip_success":this.log.info(C),this.emits(["notice","_promiseVip"],k);break;case"usage_mod":case"bad_mod_banned":case"bad_mod_mod":this.log.info(C),this.emits(["notice","_promiseMod"],x);break;case"unmod_success":this.log.info(C),this.emits(["notice","_promiseUnmod"],k);break;case"unvip_success":this.log.info(C),this.emits(["notice","_promiseUnvip"],k);break;case"usage_unmod":case"bad_unmod_mod":this.log.info(C),this.emits(["notice","_promiseUnmod"],x);break;case"usage_unvip":case"bad_unvip_grantee_not_vip":this.log.info(C),this.emits(["notice","_promiseUnvip"],x);break;case"color_changed":this.log.info(C),this.emits(["notice","_promiseColor"],k);break;case"usage_color":case"turbo_only_color":this.log.info(C),this.emits(["notice","_promiseColor"],x);break;case"commercial_success":this.log.info(C),this.emits(["notice","_promiseCommercial"],k);break;case"usage_commercial":case"bad_commercial_error":this.log.info(C),this.emits(["notice","_promiseCommercial"],x);break;case"hosts_remaining":this.log.info(C);var j=isNaN(s[0])?0:parseInt(s[0]);this.emits(["notice","_promiseHost"],[y,[null,~~j]]);break;case"bad_host_hosting":case"bad_host_rate_exceeded":case"bad_host_error":case"usage_host":this.log.info(C),this.emits(["notice","_promiseHost"],[y,[r,null]]);break;case"already_r9k_on":case"usage_r9k_on":this.log.info(C),this.emits(["notice","_promiseR9kbeta"],x);break;case"already_r9k_off":case"usage_r9k_off":this.log.info(C),this.emits(["notice","_promiseR9kbetaoff"],x);break;case"timeout_success":this.log.info(C),this.emits(["notice","_promiseTimeout"],k);break;case"delete_message_success":this.log.info("[".concat(n," ").concat(s,"]")),this.emits(["notice","_promiseDeletemessage"],k);break;case"already_subs_off":case"usage_subs_off":this.log.info(C),this.emits(["notice","_promiseSubscribersoff"],x);break;case"already_subs_on":case"usage_subs_on":this.log.info(C),this.emits(["notice","_promiseSubscribers"],x);break;case"already_emote_only_off":case"usage_emote_only_off":this.log.info(C),this.emits(["notice","_promiseEmoteonlyoff"],x);break;case"already_emote_only_on":case"usage_emote_only_on":this.log.info(C),this.emits(["notice","_promiseEmoteonly"],x);break;case"usage_slow_on":this.log.info(C),this.emits(["notice","_promiseSlow"],x);break;case"usage_slow_off":this.log.info(C),this.emits(["notice","_promiseSlowoff"],x);break;case"usage_timeout":case"bad_timeout_admin":case"bad_timeout_anon":case"bad_timeout_broadcaster":case"bad_timeout_duration":case"bad_timeout_global_mod":case"bad_timeout_mod":case"bad_timeout_self":case"bad_timeout_staff":this.log.info(C),this.emits(["notice","_promiseTimeout"],x);break;case"untimeout_success":case"unban_success":this.log.info(C),this.emits(["notice","_promiseUnban"],k);break;case"usage_unban":case"bad_unban_no_ban":this.log.info(C),this.emits(["notice","_promiseUnban"],x);break;case"usage_delete":case"bad_delete_message_error":case"bad_delete_message_broadcaster":case"bad_delete_message_mod":this.log.info(C),this.emits(["notice","_promiseDeletemessage"],x);break;case"usage_unhost":case"not_hosting":this.log.info(C),this.emits(["notice","_promiseUnhost"],x);break;case"whisper_invalid_login":case"whisper_invalid_self":case"whisper_limit_per_min":case"whisper_limit_per_sec":case"whisper_restricted":case"whisper_restricted_recipient":this.log.info(C),this.emits(["notice","_promiseWhisper"],x);break;case"no_permission":case"msg_banned":case"msg_room_not_found":case"msg_channel_suspended":case"tos_ban":case"invalid_user":this.log.info(C),this.emits(["notice","_promiseBan","_promiseClear","_promiseUnban","_promiseTimeout","_promiseDeletemessage","_promiseMods","_promiseMod","_promiseUnmod","_promiseVips","_promiseVip","_promiseUnvip","_promiseCommercial","_promiseHost","_promiseUnhost","_promiseJoin","_promisePart","_promiseR9kbeta","_promiseR9kbetaoff","_promiseSlow","_promiseSlowoff","_promiseFollowers","_promiseFollowersoff","_promiseSubscribers","_promiseSubscribersoff","_promiseEmoteonly","_promiseEmoteonlyoff","_promiseWhisper"],[y,[r,n]]);break;case"msg_rejected":case"msg_rejected_mandatory":this.log.info(C),this.emit("automod",n,r,s);break;case"unrecognized_cmd":case"cmds_available":case"host_target_went_offline":case"msg_censored_broadcaster":case"msg_duplicate":case"msg_emoteonly":case"msg_verified_email":case"msg_ratelimit":case"msg_subsonly":case"msg_timedout":case"msg_bad_characters":case"msg_channel_blocked":case"msg_facebook":case"msg_followersonly":case"msg_followersonly_followed":case"msg_followersonly_zero":case"msg_slowmode":case"msg_suspended":case"no_help":case"usage_disconnect":case"usage_help":case"usage_me":case"unavailable_command":this.log.info(C),this.emit("notice",n,r,s);break;default:s.includes("Login unsuccessful")||s.includes("Login authentication failed")||s.includes("Error logging in")||s.includes("Improperly formatted auth")?(this.wasCloseCalled=!1,this.reconnect=!1,this.reason=s,this.log.error(this.reason),this.ws.close()):s.includes("Invalid NICK")?(this.wasCloseCalled=!1,this.reconnect=!1,this.reason="Invalid NICK.",this.log.error(this.reason),this.ws.close()):(this.log.warn("Could not parse NOTICE from tmi.twitch.tv:\n".concat(JSON.stringify(e,null,4))),this.emit("notice",n,r,s))}break;case"USERNOTICE":var S=i["display-name"]||i.login,P=i["msg-param-sub-plan"]||"",N=g.unescapeIRC(g.get(i["msg-param-sub-plan-name"],""))||null,R={prime:P.includes("Prime"),plan:P,planName:N},I=~~(i["msg-param-streak-months"]||0),M=i["msg-param-recipient-display-name"]||i["msg-param-recipient-user-name"],A=~~i["msg-param-mass-gift-count"];switch(i["message-type"]=r,r){case"resub":this.emits(["resub","subanniversary"],[[n,S,I,s,i,R]]);break;case"sub":this.emits(["subscription","sub"],[[n,S,R,s,i]]);break;case"subgift":this.emit("subgift",n,S,I,M,R,i);break;case"anonsubgift":this.emit("anonsubgift",n,I,M,R,i);break;case"submysterygift":this.emit("submysterygift",n,S,A,R,i);break;case"anonsubmysterygift":this.emit("anonsubmysterygift",n,A,R,i);break;case"primepaidupgrade":this.emit("primepaidupgrade",n,S,R,i);break;case"giftpaidupgrade":var D=i["msg-param-sender-name"]||i["msg-param-sender-login"];this.emit("giftpaidupgrade",n,S,D,i);break;case"anongiftpaidupgrade":this.emit("anongiftpaidupgrade",n,S,i);break;case"raid":var U=i["msg-param-displayName"]||i["msg-param-login"],G=+i["msg-param-viewerCount"];this.emit("raided",n,U,G,i);break;case"ritual":var J=i["msg-param-ritual-name"];if("new_chatter"===J)this.emit("newchatter",n,S,i,s);else this.emit("ritual",J,n,S,i,s);break;default:this.emit("usernotice",r,n,i,s)}break;case"HOSTTARGET":var F=s.split(" "),W=~~F[1]||0;"-"===F[0]?(this.log.info("[".concat(n,"] Exited host mode.")),this.emits(["unhost","_promiseUnhost"],[[n,W],[null]])):(this.log.info("[".concat(n,"] Now hosting ").concat(F[0]," for ").concat(W," viewer(s).")),this.emit("hosting",n,F[0],W));break;case"CLEARCHAT":if(e.params.length>1){var H=g.get(e.tags["ban-duration"],null);null===H?(this.log.info("[".concat(n,"] ").concat(s," has been banned.")),this.emit("ban",n,s,null,e.tags)):(this.log.info("[".concat(n,"] ").concat(s," has been timed out for ").concat(H," seconds.")),this.emit("timeout",n,s,null,~~H,e.tags))}else this.log.info("[".concat(n,"] Chat was cleared by a moderator.")),this.emits(["clearchat","_promiseClear"],[[n],[null]]);break;case"CLEARMSG":if(e.params.length>1){var z=s,V=i.login;i["message-type"]="messagedeleted",this.log.info("[".concat(n,"] ").concat(V,"'s message has been deleted.")),this.emit("messagedeleted",n,V,z,i)}break;case"RECONNECT":this.log.info("Received RECONNECT request from Twitch.."),this.log.info("Disconnecting and reconnecting in ".concat(Math.round(this.reconnectTimer/1e3)," seconds..")),this.disconnect().catch((function(e){return t.log.error(e)})),setTimeout((function(){return t.connect().catch((function(e){return t.log.error(e)}))}),this.reconnectTimer);break;case"USERSTATE":e.tags.username=this.username,"mod"===e.tags["user-type"]&&(this.moderators[n]||(this.moderators[n]=[]),this.moderators[n].includes(this.username)||this.moderators[n].push(this.username)),g.isJustinfan(this.getUsername())||this.userstate[n]||(this.userstate[n]=i,this.lastJoined=n,this.channels.push(n),this.log.info("Joined ".concat(n)),this.emit("join",n,g.username(this.getUsername()),!0)),e.tags["emote-sets"]!==this.emotes&&this._updateEmoteset(e.tags["emote-sets"]),this.userstate[n]=i;break;case"GLOBALUSERSTATE":this.globaluserstate=i,this.emit("globaluserstate",i),void 0!==e.tags["emote-sets"]&&this._updateEmoteset(e.tags["emote-sets"]);break;case"ROOMSTATE":if(g.channel(this.lastJoined)===n&&this.emit("_promiseJoin",null,n),e.tags.channel=n,this.emit("roomstate",n,e.tags),!g.hasOwn(e.tags,"subs-only")){if(g.hasOwn(e.tags,"slow"))if("boolean"!=typeof e.tags.slow||e.tags.slow){var q=[n,!0,~~e.tags.slow];this.log.info("[".concat(n,"] This room is now in slow mode.")),this.emits(["slow","slowmode","_promiseSlow"],[q,q,[null]])}else{var Y=[n,!1,0];this.log.info("[".concat(n,"] This room is no longer in slow mode.")),this.emits(["slow","slowmode","_promiseSlowoff"],[Y,Y,[null]])}if(g.hasOwn(e.tags,"followers-only"))if("-1"===e.tags["followers-only"]){var $=[n,!1,0];this.log.info("[".concat(n,"] This room is no longer in followers-only mode.")),this.emits(["followersonly","followersmode","_promiseFollowersoff"],[$,$,[null]])}else{var B=[n,!0,~~e.tags["followers-only"]];this.log.info("[".concat(n,"] This room is now in follower-only mode.")),this.emits(["followersonly","followersmode","_promiseFollowers"],[B,B,[null]])}}break;default:this.log.warn("Could not parse message from tmi.twitch.tv:\n".concat(JSON.stringify(e,null,4)))}else if("jtv"===e.prefix)if("MODE"===e.command)"+o"===s?(this.moderators[n]||(this.moderators[n]=[]),this.moderators[n].includes(e.params[2])||this.moderators[n].push(e.params[2]),this.emit("mod",n,e.params[2])):"-o"===s&&(this.moderators[n]||(this.moderators[n]=[]),this.moderators[n].filter((function(t){return t!==e.params[2]})),this.emit("unmod",n,e.params[2]));else this.log.warn("Could not parse message from jtv:\n".concat(JSON.stringify(e,null,4)));else switch(e.command){case"353":this.emit("names",e.params[2],e.params[3].split(" "));break;case"366":break;case"JOIN":var X=e.prefix.split("!")[0];g.isJustinfan(this.getUsername())&&this.username===X&&(this.lastJoined=n,this.channels.push(n),this.log.info("Joined ".concat(n)),this.emit("join",n,X,!0)),this.username!==X&&this.emit("join",n,X,!1);break;case"PART":var K=!1,Z=e.prefix.split("!")[0];if(this.username===Z){K=!0,this.userstate[n]&&delete this.userstate[n];var Q=this.channels.indexOf(n);-1!==Q&&this.channels.splice(Q,1),-1!==(Q=this.opts.channels.indexOf(n))&&this.opts.channels.splice(Q,1),this.log.info("Left ".concat(n)),this.emit("_promisePart",null)}this.emit("part",n,Z,K);break;case"WHISPER":var ee=e.prefix.split("!")[0];this.log.info("[WHISPER] <".concat(ee,">: ").concat(s)),g.hasOwn(e.tags,"username")||(e.tags.username=ee),e.tags["message-type"]="whisper";var te=g.channel(e.tags.username);this.emits(["whisper","message"],[[te,e.tags,s,!1]]);break;case"PRIVMSG":if(e.tags.username=e.prefix.split("!")[0],"jtv"===e.tags.username){var ne=g.username(s.split(" ")[0]),se=s.includes("auto");if(s.includes("hosting you for")){var oe=g.extractNumber(s);this.emit("hosted",n,ne,oe,se)}else s.includes("hosting you")&&this.emit("hosted",n,ne,0,se)}else{var re=g.get(this.opts.options.messagesLogLevel,"info"),ie=g.actionMessage(s);if(e.tags["message-type"]=ie?"action":"chat",s=ie?ie[1]:s,g.hasOwn(e.tags,"bits"))this.emit("cheer",n,e.tags,s);else{if(g.hasOwn(e.tags,"msg-id")){if("highlighted-message"===e.tags["msg-id"]){var ae=e.tags["msg-id"];this.emit("redeem",n,e.tags.username,ae,e.tags,s)}else if("skip-subs-mode-message"===e.tags["msg-id"]){var ce=e.tags["msg-id"];this.emit("redeem",n,e.tags.username,ce,e.tags,s)}}else if(g.hasOwn(e.tags,"custom-reward-id")){var ue=e.tags["custom-reward-id"];this.emit("redeem",n,e.tags.username,ue,e.tags,s)}ie?(this.log[re]("[".concat(n,"] *<").concat(e.tags.username,">: ").concat(s)),this.emits(["action","message"],[[n,e.tags,s,!1]])):(this.log[re]("[".concat(n,"] <").concat(e.tags.username,">: ").concat(s)),this.emits(["chat","message"],[[n,e.tags,s,!1]]))}}break;default:this.log.warn("Could not parse message:\n".concat(JSON.stringify(e,null,4)))}}},_.prototype.connect=function(){var e=this;return new Promise((function(t,n){e.server=g.get(e.opts.connection.server,"irc-ws.chat.twitch.tv"),e.port=g.get(e.opts.connection.port,80),e.secure&&(e.port=443),443===e.port&&(e.secure=!0),e.reconnectTimer=e.reconnectTimer*e.reconnectDecay,e.reconnectTimer>=e.maxReconnectInterval&&(e.reconnectTimer=e.maxReconnectInterval),e._openConnection(),e.once("_promiseConnect",(function(s){s?n(s):t([e.server,~~e.port])}))}))},_.prototype._openConnection=function(){var e="".concat(this.secure?"wss":"ws","://").concat(this.server,":").concat(this.port,"/"),t={};"agent"in this.opts.connection&&(t.agent=this.opts.connection.agent),this.ws=new c(e,"irc",t),this.ws.onmessage=this._onMessage.bind(this),this.ws.onerror=this._onError.bind(this),this.ws.onclose=this._onClose.bind(this),this.ws.onopen=this._onOpen.bind(this)},_.prototype._onOpen=function(){var e=this;this._isConnected()&&(this.log.info("Connecting to ".concat(this.server," on port ").concat(this.port,"..")),this.emit("connecting",this.server,~~this.port),this.username=g.get(this.opts.identity.username,g.justinfan()),this._getToken().then((function(t){var n=g.password(t);e.log.info("Sending authentication to server.."),e.emit("logon");var s="twitch.tv/tags twitch.tv/commands";e._skipMembership||(s+=" twitch.tv/membership"),e.ws.send("CAP REQ :"+s),n?e.ws.send("PASS ".concat(n)):g.isJustinfan(e.username)&&e.ws.send("PASS SCHMOOPIIE"),e.ws.send("NICK ".concat(e.username))})).catch((function(t){e.emits(["_promiseConnect","disconnected"],[[t],["Could not get a token."]])})))},_.prototype._getToken=function(){var e,t=this.opts.identity.password;return"function"==typeof t?(e=t())instanceof Promise?e:Promise.resolve(e):Promise.resolve(t)},_.prototype._onMessage=function(e){var t=this;e.data.trim().split("\r\n").forEach((function(e){var n=p.msg(e);n&&t.handleMessage(n)}))},_.prototype._onError=function(){var e=this;this.moderators={},this.userstate={},this.globaluserstate={},clearInterval(this.pingLoop),clearTimeout(this.pingTimeout),clearTimeout(this._updateEmotesetsTimer),this.reason=null===this.ws?"Connection closed.":"Unable to connect.",this.emits(["_promiseConnect","disconnected"],[[this.reason]]),this.reconnect&&this.reconnections===this.maxReconnectAttempts&&(this.emit("maxreconnect"),this.log.error("Maximum reconnection attempts reached.")),this.reconnect&&!this.reconnecting&&this.reconnections<=this.maxReconnectAttempts-1&&(this.reconnecting=!0,this.reconnections=this.reconnections+1,this.log.error("Reconnecting in ".concat(Math.round(this.reconnectTimer/1e3)," seconds..")),this.emit("reconnect"),setTimeout((function(){e.reconnecting=!1,e.connect().catch((function(t){return e.log.error(t)}))}),this.reconnectTimer)),this.ws=null},_.prototype._onClose=function(){var e=this;this.moderators={},this.userstate={},this.globaluserstate={},clearInterval(this.pingLoop),clearTimeout(this.pingTimeout),clearTimeout(this._updateEmotesetsTimer),this.wasCloseCalled?(this.wasCloseCalled=!1,this.reason="Connection closed.",this.log.info(this.reason),this.emits(["_promiseConnect","_promiseDisconnect","disconnected"],[[this.reason],[null],[this.reason]])):(this.emits(["_promiseConnect","disconnected"],[[this.reason]]),this.reconnect&&this.reconnections===this.maxReconnectAttempts&&(this.emit("maxreconnect"),this.log.error("Maximum reconnection attempts reached.")),this.reconnect&&!this.reconnecting&&this.reconnections<=this.maxReconnectAttempts-1&&(this.reconnecting=!0,this.reconnections=this.reconnections+1,this.log.error("Could not connect to server. Reconnecting in ".concat(Math.round(this.reconnectTimer/1e3)," seconds..")),this.emit("reconnect"),setTimeout((function(){e.reconnecting=!1,e.connect().catch((function(t){return e.log.error(t)}))}),this.reconnectTimer))),this.ws=null},_.prototype._getPromiseDelay=function(){return this.currentLatency<=600?600:this.currentLatency+100},_.prototype._sendCommand=function(e,t,n,s){var o=this;return new Promise((function(r,i){if(!o._isConnected())return i("Not connected to server.");if(null!==e&&"number"!=typeof e||(null===e&&(e=o._getPromiseDelay()),g.promiseDelay(e).then((function(){return i("No response from Twitch.")}))),null!==t){var a=g.channel(t);o.log.info("[".concat(a,"] Executing command: ").concat(n)),o.ws.send("PRIVMSG ".concat(a," :").concat(n))}else o.log.info("Executing command: ".concat(n)),o.ws.send(n);"function"==typeof s?s(r,i):r()}))},_.prototype._sendMessage=function(e,t,n,s){var o=this;return new Promise((function(r,i){if(!o._isConnected())return i("Not connected to server.");if(g.isJustinfan(o.getUsername()))return i("Cannot send anonymous messages.");var a=g.channel(t);if(o.userstate[a]||(o.userstate[a]={}),n.length>=500){var c=g.splitLine(n,500);n=c[0],setTimeout((function(){o._sendMessage(e,t,c[1],(function(){}))}),350)}o.ws.send("PRIVMSG ".concat(a," :").concat(n));var u={};Object.keys(o.emotesets).forEach((function(e){return o.emotesets[e].forEach((function(e){return(g.isRegex(e.code)?p.emoteRegex:p.emoteString)(n,e.code,e.id,u)}))}));var l=Object.assign(o.userstate[a],p.emotes({emotes:p.transformEmotes(u)||null})),h=g.get(o.opts.options.messagesLogLevel,"info"),f=g.actionMessage(n);f?(l["message-type"]="action",o.log[h]("[".concat(a,"] *<").concat(o.getUsername(),">: ").concat(f[1])),o.emits(["action","message"],[[a,l,f[1],!0]])):(l["message-type"]="chat",o.log[h]("[".concat(a,"] <").concat(o.getUsername(),">: ").concat(n)),o.emits(["chat","message"],[[a,l,n,!0]])),"function"==typeof s?s(r,i):r()}))},_.prototype._updateEmoteset=function(e){var t=this,n=void 0!==e;if(n&&(e===this.emotes?n=!1:this.emotes=e),this._skipUpdatingEmotesets)n&&this.emit("emotesets",e,{});else{var s=function(){t._updateEmotesetsTimerDelay>0&&(clearTimeout(t._updateEmotesetsTimer),t._updateEmotesetsTimer=setTimeout((function(){return t._updateEmoteset(e)}),t._updateEmotesetsTimerDelay))};this._getToken().then((function(n){var s="https://api.twitch.tv/kraken/chat/emoticon_images?emotesets=".concat(e),o={};return"fetchAgent"in t.opts.connection&&(o.agent=t.opts.connection.fetchAgent),u(s,i(i({},o),{},{headers:{Accept:"application/vnd.twitchtv.v5+json",Authorization:"OAuth ".concat(g.token(n)),"Client-ID":t.clientId}}))})).then((function(e){return e.json()})).then((function(n){t.emotesets=n.emoticon_sets||{},t.emit("emotesets",e,t.emotesets),s()})).catch((function(){return s()}))}},_.prototype.getUsername=function(){return this.username},_.prototype.getOptions=function(){return this.opts},_.prototype.getChannels=function(){return this.channels},_.prototype.isMod=function(e,t){var n=g.channel(e);return this.moderators[n]||(this.moderators[n]=[]),this.moderators[n].includes(g.username(t))},_.prototype.readyState=function(){return null===this.ws?"CLOSED":["CONNECTING","OPEN","CLOSING","CLOSED"][this.ws.readyState]},_.prototype._isConnected=function(){return null!==this.ws&&1===this.ws.readyState},_.prototype.disconnect=function(){var e=this;return new Promise((function(t,n){null!==e.ws&&3!==e.ws.readyState?(e.wasCloseCalled=!0,e.log.info("Disconnecting from server.."),e.ws.close(),e.once("_promiseDisconnect",(function(){return t([e.server,~~e.port])}))):(e.log.error("Cannot disconnect from server. Socket is not opened or connection is already closing."),n("Cannot disconnect from server. Socket is not opened or connection is already closing."))}))},_.prototype.off=_.prototype.removeListener,e.exports&&(e.exports=_),"undefined"!=typeof window&&(window.tmi={client:_,Client:_})},5088:function(e,t,n){var s=n(9747);function o(e,t){var n=this;return e=s.channel(e),t=s.get(t,30),this._sendCommand(null,e,"/followers ".concat(t),(function(s,o){n.once("_promiseFollowers",(function(n){n?o(n):s([e,~~t])}))}))}function r(e){var t=this;return e=s.channel(e),this._sendCommand(null,e,"/followersoff",(function(n,s){t.once("_promiseFollowersoff",(function(t){t?s(t):n([e])}))}))}function i(e){var t=this;return e=s.channel(e),this._sendCommand(null,null,"PART ".concat(e),(function(n,s){t.once("_promisePart",(function(t){t?s(t):n([e])}))}))}function a(e){var t=this;return e=s.channel(e),this._sendCommand(null,e,"/r9kbeta",(function(n,s){t.once("_promiseR9kbeta",(function(t){t?s(t):n([e])}))}))}function c(e){var t=this;return e=s.channel(e),this._sendCommand(null,e,"/r9kbetaoff",(function(n,s){t.once("_promiseR9kbetaoff",(function(t){t?s(t):n([e])}))}))}function u(e,t){var n=this;return e=s.channel(e),t=s.get(t,300),this._sendCommand(null,e,"/slow ".concat(t),(function(s,o){n.once("_promiseSlow",(function(n){n?o(n):s([e,~~t])}))}))}function l(e){var t=this;return e=s.channel(e),this._sendCommand(null,e,"/slowoff",(function(n,s){t.once("_promiseSlowoff",(function(t){t?s(t):n([e])}))}))}e.exports={action:function(e,t){return e=s.channel(e),t="ACTION ".concat(t,""),this._sendMessage(this._getPromiseDelay(),e,t,(function(n,s){n([e,t])}))},ban:function(e,t,n){var o=this;return e=s.channel(e),t=s.username(t),n=s.get(n,""),this._sendCommand(null,e,"/ban ".concat(t," ").concat(n),(function(s,r){o.once("_promiseBan",(function(o){o?r(o):s([e,t,n])}))}))},clear:function(e){var t=this;return e=s.channel(e),this._sendCommand(null,e,"/clear",(function(n,s){t.once("_promiseClear",(function(t){t?s(t):n([e])}))}))},color:function(e,t){var n=this;return t=s.get(t,e),this._sendCommand(null,"#tmijs","/color ".concat(t),(function(e,s){n.once("_promiseColor",(function(n){n?s(n):e([t])}))}))},commercial:function(e,t){var n=this;return e=s.channel(e),t=s.get(t,30),this._sendCommand(null,e,"/commercial ".concat(t),(function(s,o){n.once("_promiseCommercial",(function(n){n?o(n):s([e,~~t])}))}))},deletemessage:function(e,t){var n=this;return e=s.channel(e),this._sendCommand(null,e,"/delete ".concat(t),(function(t,s){n.once("_promiseDeletemessage",(function(n){n?s(n):t([e])}))}))},emoteonly:function(e){var t=this;return e=s.channel(e),this._sendCommand(null,e,"/emoteonly",(function(n,s){t.once("_promiseEmoteonly",(function(t){t?s(t):n([e])}))}))},emoteonlyoff:function(e){var t=this;return e=s.channel(e),this._sendCommand(null,e,"/emoteonlyoff",(function(n,s){t.once("_promiseEmoteonlyoff",(function(t){t?s(t):n([e])}))}))},followersonly:o,followersmode:o,followersonlyoff:r,followersmodeoff:r,host:function(e,t){var n=this;return e=s.channel(e),t=s.username(t),this._sendCommand(2e3,e,"/host ".concat(t),(function(s,o){n.once("_promiseHost",(function(n,r){n?o(n):s([e,t,~~r])}))}))},join:function(e){var t=this;return e=s.channel(e),this._sendCommand(void 0,null,"JOIN ".concat(e),(function(n,o){var r="_promiseJoin",i=!1;t.on(r,(function a(c,u){e===s.channel(u)&&(t.removeListener(r,a),i=!0,c?o(c):n([e]))}));var a=t._getPromiseDelay();s.promiseDelay(a).then((function(){i||t.emit(r,"No response from Twitch.",e)}))}))},mod:function(e,t){var n=this;return e=s.channel(e),t=s.username(t),this._sendCommand(null,e,"/mod ".concat(t),(function(s,o){n.once("_promiseMod",(function(n){n?o(n):s([e,t])}))}))},mods:function(e){var t=this;return e=s.channel(e),this._sendCommand(null,e,"/mods",(function(n,s){t.once("_promiseMods",(function(o,r){o?s(o):(r.forEach((function(n){t.moderators[e]||(t.moderators[e]=[]),t.moderators[e].includes(n)||t.moderators[e].push(n)})),n(r))}))}))},part:i,leave:i,ping:function(){var e=this;return this._sendCommand(null,null,"PING",(function(t,n){e.latency=new Date,e.pingTimeout=setTimeout((function(){null!==e.ws&&(e.wasCloseCalled=!1,e.log.error("Ping timeout."),e.ws.close(),clearInterval(e.pingLoop),clearTimeout(e.pingTimeout))}),s.get(e.opts.connection.timeout,9999)),e.once("_promisePing",(function(e){return t([parseFloat(e)])}))}))},r9kbeta:a,r9kmode:a,r9kbetaoff:c,r9kmodeoff:c,raw:function(e){return this._sendCommand(null,null,e,(function(t,n){t([e])}))},say:function(e,t){return e=s.channel(e),t.startsWith(".")&&!t.startsWith("..")||t.startsWith("/")||t.startsWith("\\")?"me "===t.substr(1,3)?this.action(e,t.substr(4)):this._sendCommand(null,e,t,(function(n,s){n([e,t])})):this._sendMessage(this._getPromiseDelay(),e,t,(function(n,s){n([e,t])}))},slow:u,slowmode:u,slowoff:l,slowmodeoff:l,subscribers:function(e){var t=this;return e=s.channel(e),this._sendCommand(null,e,"/subscribers",(function(n,s){t.once("_promiseSubscribers",(function(t){t?s(t):n([e])}))}))},subscribersoff:function(e){var t=this;return e=s.channel(e),this._sendCommand(null,e,"/subscribersoff",(function(n,s){t.once("_promiseSubscribersoff",(function(t){t?s(t):n([e])}))}))},timeout:function(e,t,n,o){var r=this;return e=s.channel(e),t=s.username(t),null===n||s.isInteger(n)||(o=n,n=300),n=s.get(n,300),o=s.get(o,""),this._sendCommand(null,e,"/timeout ".concat(t," ").concat(n," ").concat(o),(function(s,i){r.once("_promiseTimeout",(function(r){r?i(r):s([e,t,~~n,o])}))}))},unban:function(e,t){var n=this;return e=s.channel(e),t=s.username(t),this._sendCommand(null,e,"/unban ".concat(t),(function(s,o){n.once("_promiseUnban",(function(n){n?o(n):s([e,t])}))}))},unhost:function(e){var t=this;return e=s.channel(e),this._sendCommand(2e3,e,"/unhost",(function(n,s){t.once("_promiseUnhost",(function(t){t?s(t):n([e])}))}))},unmod:function(e,t){var n=this;return e=s.channel(e),t=s.username(t),this._sendCommand(null,e,"/unmod ".concat(t),(function(s,o){n.once("_promiseUnmod",(function(n){n?o(n):s([e,t])}))}))},unvip:function(e,t){var n=this;return e=s.channel(e),t=s.username(t),this._sendCommand(null,e,"/unvip ".concat(t),(function(s,o){n.once("_promiseUnvip",(function(n){n?o(n):s([e,t])}))}))},vip:function(e,t){var n=this;return e=s.channel(e),t=s.username(t),this._sendCommand(null,e,"/vip ".concat(t),(function(s,o){n.once("_promiseVip",(function(n){n?o(n):s([e,t])}))}))},vips:function(e){var t=this;return e=s.channel(e),this._sendCommand(null,e,"/vips",(function(e,n){t.once("_promiseVips",(function(t,s){t?n(t):e(s)}))}))},whisper:function(e,t){var n=this;return(e=s.username(e))===this.getUsername()?Promise.reject("Cannot send a whisper to the same account."):this._sendCommand(null,"#tmijs","/w ".concat(e," ").concat(t),(function(e,t){n.once("_promiseWhisper",(function(e){e&&t(e)}))})).catch((function(o){if(o&&"string"==typeof o&&0!==o.indexOf("No response from Twitch."))throw o;var r=s.channel(e),i=Object.assign({"message-type":"whisper","message-id":null,"thread-id":null,username:n.getUsername()},n.globaluserstate);return n.emits(["whisper","message"],[[r,i,t,!0],[r,i,t,!0]]),[e,t]}))}}},1322:function(e){function t(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function s(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}e.exports=t,t.EventEmitter=t,t.prototype._events=void 0,t.prototype._maxListeners=void 0,t.defaultMaxListeners=10,t.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},t.prototype.emit=function(e){var t,r,i,a,c,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(o(r=this._events[e]))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),r.apply(this,a)}else if(s(r))for(a=Array.prototype.slice.call(arguments,1),i=(u=r.slice()).length,c=0;c<i;c++)u[c].apply(this,a);return!0},t.prototype.addListener=function(e,r){var i;if(!n(r))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(r.listener)?r.listener:r),this._events[e]?s(this._events[e])?this._events[e].push(r):this._events[e]=[this._events[e],r]:this._events[e]=r,s(this._events[e])&&!this._events[e].warned&&(i=o(this._maxListeners)?t.defaultMaxListeners:this._maxListeners)&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},t.prototype.on=t.prototype.addListener,t.prototype.once=function(e,t){if(!n(t))throw TypeError("listener must be a function");var s=!1;if(this._events.hasOwnProperty(e)&&"_"===e.charAt(0)){var o=1,r=e;for(var i in this._events)this._events.hasOwnProperty(i)&&i.startsWith(r)&&o++;e+=o}function a(){"_"!==e.charAt(0)||isNaN(e.substr(e.length-1))||(e=e.substring(0,e.length-1)),this.removeListener(e,a),s||(s=!0,t.apply(this,arguments))}return a.listener=t,this.on(e,a),this},t.prototype.removeListener=function(e,t){var o,r,i,a;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=(o=this._events[e]).length,r=-1,o===t||n(o.listener)&&o.listener===t){if(delete this._events[e],this._events.hasOwnProperty(e+"2")&&"_"===e.charAt(0)){var c=e;for(var u in this._events)this._events.hasOwnProperty(u)&&u.startsWith(c)&&(isNaN(parseInt(u.substr(u.length-1)))||(this._events[e+parseInt(u.substr(u.length-1)-1)]=this._events[u],delete this._events[u]));this._events[e]=this._events[e+"1"],delete this._events[e+"1"]}this._events.removeListener&&this.emit("removeListener",e,t)}else if(s(o)){for(a=i;a-- >0;)if(o[a]===t||o[a].listener&&o[a].listener===t){r=a;break}if(r<0)return this;1===o.length?(o.length=0,delete this._events[e]):o.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},t.prototype.removeAllListeners=function(e){var t,s;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n(s=this._events[e]))this.removeListener(e,s);else if(s)for(;s.length;)this.removeListener(e,s[s.length-1]);return delete this._events[e],this},t.prototype.listeners=function(e){return this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},t.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},t.listenerCount=function(e,t){return e.listenerCount(t)}},6778:function(e,t,n){var s=n(9747),o="info",r={trace:0,debug:1,info:2,warn:3,error:4,fatal:5};function i(e){return function(t){r[e]>=r[o]&&console.log("[".concat(s.formatDate(new Date),"] ").concat(e,": ").concat(t))}}e.exports={setLevel:function(e){o=e},trace:i("trace"),debug:i("debug"),info:i("info"),warn:i("warn"),error:i("error"),fatal:i("fatal")}},8322:function(e,t,n){var s=n(9747),o=/\S+/g;function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:",",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/",o=arguments.length>4?arguments[4]:void 0,r=e[t];if(void 0===r)return e;var i="string"==typeof r;if(e[t+"-raw"]=i?r:null,!0===r)return e[t]=null,e;if(e[t]={},i)for(var a=r.split(n),c=0;c<a.length;c++){var u=a[c].split(s),l=u[1];void 0!==o&&l&&(l=l.split(o)),e[t][u[0]]=l||null}return e}e.exports={badges:function(e){return r(e,"badges")},badgeInfo:function(e){return r(e,"badge-info")},emotes:function(e){return r(e,"emotes","/",":",",")},emoteRegex:function(e,t,n,r){o.lastIndex=0;for(var i,a=new RegExp("(\\b|^|\\s)"+s.unescapeHtml(t)+"(\\b|$|\\s)");null!==(i=o.exec(e));)a.test(i[0])&&(r[n]=r[n]||[],r[n].push([i.index,o.lastIndex-1]))},emoteString:function(e,t,n,r){var i;for(o.lastIndex=0;null!==(i=o.exec(e));)i[0]===s.unescapeHtml(t)&&(r[n]=r[n]||[],r[n].push([i.index,o.lastIndex-1]))},transformEmotes:function(e){var t="";return Object.keys(e).forEach((function(n){t="".concat(t+n,":"),e[n].forEach((function(e){return t="".concat(t+e.join("-"),",")})),t="".concat(t.slice(0,-1),"/")})),t.slice(0,-1)},formTags:function(e){var t=[];for(var n in e){var o=s.escapeIRC(e[n]);t.push("".concat(n,"=").concat(o))}return"@".concat(t.join(";"))},msg:function(e){var t={raw:e,tags:{},prefix:null,command:null,params:[]},n=0,s=0;if(64===e.charCodeAt(0)){if(-1===(s=e.indexOf(" ")))return null;for(var o=e.slice(1,s).split(";"),r=0;r<o.length;r++){var i=o[r],a=i.split("=");t.tags[a[0]]=i.substring(i.indexOf("=")+1)||!0}n=s+1}for(;32===e.charCodeAt(n);)n++;if(58===e.charCodeAt(n)){if(-1===(s=e.indexOf(" ",n)))return null;for(t.prefix=e.slice(n+1,s),n=s+1;32===e.charCodeAt(n);)n++}if(-1===(s=e.indexOf(" ",n)))return e.length>n?(t.command=e.slice(n),t):null;for(t.command=e.slice(n,s),n=s+1;32===e.charCodeAt(n);)n++;for(;n<e.length;){if(s=e.indexOf(" ",n),58===e.charCodeAt(n)){t.params.push(e.slice(n+1));break}if(-1===s){if(-1===s){t.params.push(e.slice(n));break}}else for(t.params.push(e.slice(n,s)),n=s+1;32===e.charCodeAt(n);)n++}return t}}},196:function(e,t,n){var s=n(4575),o=n(3913),r=function(){"use strict";function e(t){s(this,e),this.queue=[],this.index=0,this.defaultDelay=void 0===t?3e3:t}return o(e,[{key:"add",value:function(e,t){this.queue.push({fn:e,delay:t})}},{key:"next",value:function(){var e=this,t=this.index++,n=this.queue[t];if(n){var s=this.queue[this.index];if(n.fn(),s){var o=void 0===s.delay?this.defaultDelay:s.delay;setTimeout((function(){return e.next()}),o)}}}}]),e}();e.exports=r},9747:function(e){var t=/^\u0001ACTION ([^\u0001]+)\u0001$/,n=/^(justinfan)(\d+$)/,s=/\\([sn:r\\])/g,o=/([ \n;\r\\])/g,r={s:" ",n:"",":":";",r:""},i={" ":"s","\n":"n",";":":","\r":"r"},a=new RegExp("^(?:(?:https?|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#]\\S*)?$","i"),c=/[|\\^$*+?:#]/,u=e.exports={get:function(e,t){return void 0===e?t:e},hasOwn:function(e,t){return{}.hasOwnProperty.call(e,t)},promiseDelay:function(e){return new Promise((function(t){return setTimeout(t,e)}))},isFinite:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return isFinite(e)&&!isNaN(parseFloat(e))})),toNumber:function(e,t){if(null===e)return 0;var n=Math.pow(10,u.isFinite(t)?t:0);return Math.round(e*n)/n},isInteger:function(e){return!isNaN(u.toNumber(e,0))},isRegex:function(e){return c.test(e)},isURL:function(e){return a.test(e)},justinfan:function(){return"justinfan".concat(Math.floor(8e4*Math.random()+1e3))},isJustinfan:function(e){return n.test(e)},channel:function(e){var t=(e||"").toLowerCase();return"#"===t[0]?t:"#"+t},username:function(e){var t=(e||"").toLowerCase();return"#"===t[0]?t.slice(1):t},token:function(e){return e?e.toLowerCase().replace("oauth:",""):""},password:function(e){var t=u.token(e);return t?"oauth:".concat(t):""},actionMessage:function(e){return e.match(t)},replaceAll:function(e,t){if(null==e)return null;for(var n in t)e=e.replace(new RegExp(n,"g"),t[n]);return e},unescapeHtml:function(e){return e.replace(/\\&amp\\;/g,"&").replace(/\\&lt\\;/g,"<").replace(/\\&gt\\;/g,">").replace(/\\&quot\\;/g,'"').replace(/\\&#039\\;/g,"'")},unescapeIRC:function(e){return e&&"string"==typeof e&&e.includes("\\")?e.replace(s,(function(e,t){return t in r?r[t]:t})):e},escapeIRC:function(e){return e&&"string"==typeof e?e.replace(o,(function(e,t){return t in i?"\\".concat(i[t]):t})):e},addWord:function(e,t){return e.length?e+" "+t:e+t},splitLine:function(e,t){var n=e.substring(0,t).lastIndexOf(" ");return-1===n&&(n=t-1),[e.substring(0,n),e.substring(n+1)]},extractNumber:function(e){for(var t=e.split(" "),n=0;n<t.length;n++)if(u.isInteger(t[n]))return~~t[n];return 0},formatDate:function(e){var t=e.getHours(),n=e.getMinutes();return n=(n<10?"0":"")+n,"".concat(t=(t<10?"0":"")+t,":").concat(n)},inherits:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e},isNode:function(){try{return"object"==typeof process&&"[object process]"===Object.prototype.toString.call(process)}catch(e){}return!1}}},308:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var s=n(5785),o=n(7555),r=n.n(o),i=n(7294);function a(e){var t,n=e.color,s=e.thickness,o=e.emitter,r=(0,i.createRef)(),a={drawable:!1,X:-1,Y:-1},c=function(e){t.strokeStyle=n,t.lineWidth=s,t.lineCap="round",t.lineJoin="round",t.beginPath(),a=Object.assign({drawable:!0},h(e))},u=function(e){a.drawable&&(a=Object.assign({},a,h(e)),t.lineTo(a.X,a.Y),t.stroke())},l=function(){a={drawable:!1,X:-1,Y:-1}},h=function(e){return{X:e.offsetX,Y:e.offsetY}},f=function(){var e=r.current;e&&(e.style.width="100%",e.style.height="100%",e.width=e.offsetWidth,e.height=e.offsetHeight)};return o.on("erase",(function(){var e=r.current;e&&t.clearRect(0,0,e.width,e.height)})),(0,i.useEffect)((function(){f()}),[]),(0,i.useEffect)((function(){var e,n=r.current;n&&(t=null!==(e=t)&&void 0!==e?e:n.getContext("2d"),window.addEventListener("resize",f),n.addEventListener("mousedown",c),n.addEventListener("mousemove",u),n.addEventListener("mouseup",l),n.addEventListener("mouseout",l))}),[n,s]),i.createElement("canvas",{className:"drawing-canvas",ref:r})}var c=n(5900),u=n.n(c);function l(e){var t=e.onColorSelect,n=e.onErase,o=e.setThickness,r=e.thickness,a=(0,i.useRef)(0),c=(0,i.useState)(Array.from({length:10})),l=c[0],h=c[1],f=(0,i.useState)({i:0,j:9}),m=f[0],p=f[1],d=function(e,n,s){p({i:n,j:s}),t(e)};return i.createElement("div",{className:"color-palette-container"},["red","orange","yellow","green","blue","purple","pink","brown","white","black"].map((function(e,t){return i.createElement("button",{key:"default-color-"+t,className:u()("color-palette-item",{selected:0===m.i&&m.j===t}),style:{backgroundColor:e},type:"button",onClick:function(){return d(e,0,t)}})})),i.createElement("input",{className:"color-palette-item",type:"color",onChange:function(e){var t=a.current,n=(0,s.Z)(l);n[t]=e.target.value,a.current=(a.current+1)%l.length,h(n)}}),l.map((function(e,t){return i.createElement("button",{key:"selected-color-"+t,className:u()("color-palette-item",{selected:1===m.i&&m.j===t}),style:{backgroundColor:e},type:"button",onClick:function(){e&&d(e,1,t)}})})),i.createElement("button",{className:"color-palette-item eraser",onClick:n},i.createElement("svg",{viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#000000",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},i.createElement("path",{d:"M19 19h-11l-4 -4a1 1 0 0 1 0 -1.41l10 -10a1 1 0 0 1 1.41 0l5 5a1 1 0 0 1 0 1.41l-9 9"}),i.createElement("line",{x1:"18",y1:"12.3",x2:"11.7",y2:"6"}))),i.createElement("div",{className:"thickness",onWheel:function(e){e.deltaY>0&&o((function(e){return e<=1?e:e-1})),e.deltaY<0&&o((function(e){return e>=64?e:e+1}))}},i.createElement("svg",{width:"100",viewBox:"0 0 100 100"},i.createElement("circle",{cx:"50%",cy:"50%",r:r/2}))))}var h=n(9393),f=n(264);function m(e){var t=e.remained,n=e.current,o=e.onAnswer,c=(0,i.useRef)(null),u=(0,i.useState)(null),m=u[0],p=u[1],d=(0,i.useState)(null),g=d[0],v=d[1],_=(0,i.useState)("black"),y=_[0],b=_[1],w=(0,i.useState)(5),k=w[0],x=w[1],C=new(r());return(0,i.useEffect)((function(){!g&&t>0&&(0,h.S$)(null!=m?m:h.CE,"문제를 출제해주세요!")}),[g]),(0,i.useEffect)((function(){if(n){var e=n.msg,t=e.command,s=e.args;if("!정답"===t){if(!g)return;if(s.length<1)return;if(n.state.username===m)return;var r=s.join("");if(g!==r)return;c.current=g,o(n.state.username),v(null),p(n.state.username)}if("!출제"===t){if(g)return;if(s.length<1)return;n.state.username!==(null!=m?m:h.CE)&&n.state.username!==h.CE||(v(s.join("")),p(n.state.username),n.state.username!==h.CE&&(0,h.S$)(h.CE,n.state.username+"님이 출제한 문제는 '"+s.join(" ")+"' 입니다!"))}}}),[n]),g?i.createElement("div",{className:"draw-space-container"},i.createElement(a,{color:y,thickness:k,emitter:C}),i.createElement(l,{onColorSelect:b,onErase:function(){C.emit("erase")},setThickness:x,thickness:k})):i.createElement(f.default,{title:m?m+" 님이 맞췄어요! 정답은 "+c.current+" 였어요.":"문제를 출제해주세요!",subtitles:[].concat((0,s.Z)(m?[m+"님에게 아까 귓속말을 보냈던 '러리'가 귓속말을 보냈을 거에요.","그 유저에게 '!출제 [문제]'를 보내주세요. 정답자가 계속 출제하지 않는다면, 스트리머도 출제할 수 있어요."]:["아까 귓속말을 보냈던 '러리'에게 '!출제 [문제]'를 보내주세요."]),["띄어쓰기 여부는 상관 없으니, 원하시는 대로 입력해주시면 됩니다!","정답을 알겠다면, '!정답 [생각하는 정답]을 채팅창에 입력해주세요."])})}},264:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var s=n(7294);function o(e){var t=e.title,n=e.subtitles;return s.createElement("div",{className:"text-only-page"},s.createElement("h1",null,t),null==n?void 0:n.map((function(e,t){return s.createElement("p",{key:"subtitle-"+t},e)})))}},9393:function(e,t,n){"use strict";function s(e,t,n,s,o,r,i){try{var a=e[r](i),c=a.value}catch(u){return void n(u)}a.done?t(c):Promise.resolve(c).then(s,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function a(e){s(i,o,r,a,c,"next",e)}function c(e){s(i,o,r,a,c,"throw",e)}a(void 0)}))}}n.d(t,{CE:function(){return c},S1:function(){return m},S$:function(){return h}});var r=n(7757),i=n.n(r),a=n(8746),c="derbls",u=new a.client({identity:{username:"Coalery",password:"oauth:nzzkmt07943mw1ymjjzmysav2n426y"},channels:[c]});function l(e){var t=e.split(" ");return{command:t[0],args:1===t.length?[]:t.slice(1)}}function h(e,t){return f.apply(this,arguments)}function f(){return(f=o(i().mark((function e(t,n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.whisper(t,n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return p=o(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.on("message",(function(e,n,s,o){!o&&n.username&&"!"==s[0]&&t({channel:e,state:n,msg:l(s),self:o})})),e.next=3,u.connect();case 3:console.log("Connected!");case 4:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}},2604:function(){},8726:function(){}}]);
//# sourceMappingURL=c946b5e2b0dbd32544e13ec6cf1adf26acf56c46-370c9e1394d423f34d62.js.map